<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Do script ao pacote de R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Andrea S√°nchez-Tapia   N√∫cleo de Computa√ß√£o Cient√≠fica e Geoprocessamento   Jardim Bot√¢nico do Rio de Janeiro" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/font-awesome/css/fontawesome-all.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Do <em>script</em> ao pacote de R
## um exemplo desde a biologia
### Andrea S√°nchez-Tapia <br> N√∫cleo de Computa√ß√£o Cient√≠fica e Geoprocessamento <br> Jardim Bot√¢nico do Rio de Janeiro
### 20-07-2020

---

background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px


### Apresenta√ß√£o


+ Bi√≥loga - Universidade Nacional da Col√¥mbia  
+ Mestre em Ecologia - UFRJ
+ Doutora em Bot√¢nica - JBRJ
+ .purple[P√≥s-doc - N√∫cleo de Computa√ß√£o Cient√≠fica e Geoprocessamento do JBRJ]

Ecologia de comunidades vegetais, restaura√ß√£o ecol√≥gica, ecologia quantitativa  

__Inform√°tica da biodiversidade__, modelagem de nicho ecol√≥gico

__Ci√™ncia aberta e reprodut√≠vel__, √©tica na ci√™ncia de dados, ci√™ncia de dados feminista



---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### Apresenta√ß√£o

+ Como trabalhar apenas com software _libre_? 

+ Usu√°ria de `R` desde 2009

+ __O alvo hoje__: Executar e ensinar a fazer projetos de an√°lise reprodut√≠veis. Desde o download e processamento de dados at√© produzir o manuscrito, relat√≥rio ou apresenta√ß√£o (__`rmarkdown`__, __`knitr`__)

+ R-Ladies+ Rio desde 2016 

 &lt;!-- + Co-fundadora de .red[__¬°liibre!__] com Sara Mortara (R-Ladies+ Rio): laborat√≥rio de inform√°tica da biodiversidade e reprodutibilidade em ecologia--&gt; 

---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px


### Curso sobre ci√™ncia aberta e fluxos de trabalho reprodut√≠veis

.pull-left[
&lt;img src="./figs/turma.JPG" width="300" /&gt;


&lt;img src="./figs/logo_jbrj.png" width="100" /&gt;
]

.pull-right[

__Boas pr√°ticas__ em an√°lise de dados

&lt;img src="./figs/rstudio.jpg" width="200" /&gt;

&lt;img src="./figs/logo-git.png" width="80" /&gt;&lt;img src="./figs/GitHub_Logo.png" width="80" /&gt;&lt;img src="./figs/btibucket.png" width="80" /&gt;&lt;img src="./figs/gitlab-logo-gray-rgb.png" width="80" /&gt;

&lt;img src="./figs/latex.jpeg" width="100" /&gt;&lt;img src="./figs/bibtex.jpeg" width="100" /&gt;&lt;img src="./figs/zotero.svg" width="100" /&gt;
&lt;img src="./figs/rmarkdown.png" width="50" /&gt;

&lt;img src="./figs/xaringan.png" width="60" /&gt;
]


 &lt;!-- pensada como semin√°rio
 alunes de v√°rias √°reas do conhecimento
 ferramentas que n√£o t√™m um ensino formal
 de grande utilidade --&gt; 

---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### Por que a √™nfase em reprodutibilidade?

+ Transpar√™ncia
+ Portabilidade - colabora√ß√£o!
+ Corre√ß√£o de erros `-&gt;` robusteza
+ Comunica√ß√£o

Para criar um pacote de R precisa ser todas estas coisas

### Mas _bem antes_ de chegar ao pacote tamb√©m √© bom implementar estas boas pr√°ticas!


---
class: middle
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### Pacote de R para modelagem de nicho &lt;br&gt; ecol√≥gico: .red[modleR]

+ __Unificar__ diferentes partes do processo de MNE
+ Fornecer __metadados__ e __documentar__ decis√µes de parametriza√ß√£o
+ Se __integrar__ ao resto de ferramentas que existem no ambiente de `R`

&lt;br&gt;
&lt;img src="./figs/mm.png" width="151" /&gt;
&lt;img src="./figs/coleguinhes.png" width="600" /&gt;

&lt;small&gt;
Marinez F Siqueira, Sara Mortara, Diogo Rocha, Guilherme Gall, Felipe Sodr√©
&lt;/small&gt;

.pull-left[

<i class="fab  fa-firefox "></i> 
&lt;small&gt;
[https://model-r.github.io/modleR/](https://model-r.github.io/modleR/)
&lt;/small&gt;
]

.pull-right[
&lt;p style="text-align:center;"&gt;

<i class="fab  fa-youtube "></i> 

&lt;small&gt;
&lt;a href="https://www.youtube.com/watch?v=4Xw33TdIVXA"&gt;Aula no curso ENM-2020&lt;/a&gt;

&lt;/small&gt;
&lt;/p&gt;

]

---
class: bottom, center
background-image: url("figs/modleR.png")
background-position: 50% 0%
background-size: 800px

&lt;img src="./figs/preprint.png" width="800" /&gt;


---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### Modelos de nicho ecol√≥gico ou de &lt;br&gt; distribui√ß√£o das esp√©cies (ENM, SDM)

+ Dados de ocorr√™ncia das esp√©cies: __objetos espaciais__, bases de dados, limpeza de dados.

+ Camadas preditoras ambientais ( __rasters__ de SIG)  Pacotes __`raster`__, __`sp`__, __`maps`__, __`rgdal`__: (taskview Spatial)

+ Abordagem de aprendizado estat√≠stico 

+ Diferentes algoritmos
 
+ __Infer√™ncia de √°reas adequadas para a ocorr√™ncia das esp√©cies__

---
class: inverse, middle, center
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### A gente j√° conhecia algumas boas pr√°ticas



---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### Boas pr√°ticas ‚ù§Ô∏è &lt;br&gt; estrutura de pastas e pasta de trabalho 

+ _Meetup_ anterior! [link](https://www.youtube.com/watch?time_continue=1563&amp;v=4nfIbiS1Huw&amp;feature=emb_title) e arquivo .zip 

--

+ N√£o use `setwd()`! üî•

--

+ N√£o mude de pasta de trabalho ao longo do projeto: use __caminhos relativos__

--
    
  + Caminhos absolutos: `"C://Eu/Minha_pasta/arquivo_meu_v_13.csv"`

--

  + Caminhos relativos: `"./data"`, `"./figs"`
  
--

 + O n√≠vel acima √© com dois pontos: `..`

--

 + Uma pasta "do lado" √© uma subpasta desse n√≠vel acima: `"../pasta_irm√£"`


---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### Boas pr√°ticas ‚ù§Ô∏è &lt;br&gt; estrutura de pastas e pasta de trabalho 

+ Cuide da estrutura de pastas
--

```bash
.
‚îú‚îÄ‚îÄ codigo/    # Scripts em R
‚îú‚îÄ‚îÄ dados/     # Dados 
‚îú‚îÄ‚îÄ output/    # Outputs gerados a partir dos c√≥digos
‚îú‚îÄ‚îÄ figs/      # Figuras geradas a partir dos c√≥digos
‚îú‚îÄ‚îÄ docs/      # Relat√≥rios reprodut√≠veis a partir dos outputs
‚îú‚îÄ‚îÄ *.Rproj    # Projeto de RStudio
‚îú‚îÄ‚îÄ .gitignore # Lista dos arquivos e pastas que n√£o ser√£o controlados
‚îî‚îÄ‚îÄ README.md   
```
--

+ Abra as sess√µes de R j√° na pasta de trabalho
--

 + Um atalho: usar o pacote __rprojroot__ ou __here__
--

 + Um atalho melhor: usar projetos de .blue[RStudio]

---
class: inverse, center, middle

# A hist√≥ria

---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### Primeira etapa: _scripts_ soltos

#### O trabalho: gerar uma camada de diversidade potencial de plantas &lt;br&gt; da Mata Atl√¢ntica

+ A "maior" quantidade poss√≠vel de esp√©cies
+ Muito controle sobre a qualidade dos modelos
+ Corre√ß√£o taxon√¥mica, limpeza dos registros
+ Alta resolu√ß√£o (30s ~1km)

--

#### O fluxo de trabalho: cada esp√©cie precisa passar por v√°rias etapas

+ Obten√ß√£o, __limpeza__ de dados
+ Desenho experimental, __prepara√ß√£o__ dos dados
+ Ajustar os __modelos__, __projetar__ os modelos para v√°rios algoritmos
+ Juntar os resultados dos diferentes algoritmos
+ Juntar o resultado para v√°rias esp√©cies

---
### Primeira etapa: _scripts_ soltos

+ Um script para __uma__ esp√©cie (fazia todas as etapas de vez)

--

+ Um `"for loop"` para fazer para v√°rias esp√©cies

--

```r
lista_de_especies &lt;- c("sp1", "sp2", "sp3")
```

--

```r
for (especie in lista_de_especies) { # pode ter qualquer nome, i
    todo_o_codigo(especie)
}
```

--

```r
especie &lt;- sp1
todo_o_codigo(sp1)

especie &lt;- sp2
todo_o_codigo(sp2)

especie &lt;- sp3
todo_o_codigo(sp3)
```


---
background-image: url('figs/hadley.jpg')
background-size: 150px
background-position: 90% 10%

### Criar fun√ß√µes


"Se voc√™ est√° copiando e colando seu c√≥digo mais   
de tr√™s vezes, √© hora de escrever uma fun√ß√£o"

`Hadley Wickham`

--


```r
modelar &lt;- function(x) {
    y &lt;- ...(x)
    return(y)
}

# Uma esp√©cie
modelar(especie)

# V√°rias esp√©cies
lapply(lista_de_especies, modelar)

purrr::map(lista_de_especies, 
           ~modelar)
```

--

#### A fun√ß√£o ainda rodava todas as etapas da an√°lise para cada esp√©cie!

---
background-image: url('figs/alltest_alphamap1.png')
background-position: 95% 50%
background-size: 45%
class: inverse

### Rodava!  
--

### Matava a RAM :/
--

### Demorava 10 dias ¬¨¬¨ 
--

### Fazia uma esp√©cie ap√≥s &lt;br&gt; a outra

--

&lt;img src="figs/felipe.png" width="70" /&gt;

Felipe Sodr√©


---
background-image: url('./figs/lncc.png')
background-size: 300px
background-position: 90% 10%

### Segunda etapa

+ Capacidade de computa√ß√£o 
+ Computa√ß√£o remota (VPN, ssh)
+ __Paraleliza√ß√£o__ 
  + Separar os quatro processos em fun√ß√µes diferentes
+ Escrever c√≥digo em colabora√ß√£o: 
  + Cuidar do __estilo de c√≥digo__ 
  + __Come√ßar a usar controle de vers√µes__ (git/GitHub)


--


![Wa](figs/math.gif)


---
### Paraleliza√ß√£o

+ Cada processo vai para um _core_ (os computadores de hoje t√™m 4 _cores_)
+ Os _clusters_ de computa√ß√£o podem ter v√°rias centenas de _cores_
+ H√° v√°rias maneiras de paralelizar processos em R

```r
library(parallel)
library(snowfall)
library(foreach)
library(futures)
```

```r
sfInit(parallel = T, cpus = 3)
sfExportAll() # para que cada n√∫cleo receba as vari√°veis do workspace
sfLapply(lista_de_especies, modelar)
sfStop()
```

### Passou de 10 dias para algumas horas ¬¨¬¨


---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### __Modularizar__ o c√≥digo

+ Cada core ainda executava o processo inteiro

+ E se a gente rodasse um processo por vez para todas as esp√©cies? 

+ Na hora de repetir n√£o precisava voltar at√© o in√≠cio

+ Quatro fun√ß√µes!


---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px
### Controle de vers√µes: Git e GitHub

&lt;img src="./figs/logo-git.png" width="80" /&gt;&lt;img src="./figs/GitHub_Logo.png" width="80" /&gt;&lt;img src="./figs/btibucket.png" width="80" /&gt;&lt;img src="./figs/gitlab-logo-gray-rgb.png" width="80" /&gt;

+ Git √© o programa que lida localmente
+ O GitHub √© um portal remoto, existem outros (BitBucket, Gitlab)

---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### Git: baseado em __commits__

&lt;img src="./figs/snapshots.png" width="600" /&gt;

.footnote[
[https://git-scm.com/book/en/v2/Getting-Started-About-Version-Control](https://git-scm.com/book/en/v2/Getting-Started-About-Version-Control)
]

---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### Git: modo diff

&lt;img src="figs/diff.png" width="600" /&gt;

.footnote[
[https://git-scm.com/book/en/v2/Getting-Started-Git-Basics](https://git-scm.com/book/en/v2/Getting-Started-Git-Basics)
]

---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px

### Git: local e remoto

&lt;img src="figs/areas.png" width="600" /&gt;

.footnote[
[https://git-scm.com/book/en/v2/Getting-Started-Git-Basics](https://git-scm.com/book/en/v2/Getting-Started-Git-Basics)
]

---
background-image: url("figs/chevron.png")
background-position: 98% 2%
background-size: 150px
### We ‚ù§Ô∏è &lt;img src="figs/logo-git.png" width="70" /&gt;


+ Backup

--

+ Controle de vers√µes

--

+ Reprodutibilidade

--

+ Workflow colaborativo

--

+ Transpar√™ncia


#### √â preciso padronizar o jeito de escrever o c√≥digo!*

---
background-image: url('figs/hadley.jpg')
background-size: 150px
background-position: 90% 10%

### Estilo de c√≥digo

"Um bom estilo de c√≥digo √© como usar uma boa pontua√ß√£o. &lt;br&gt;  Voc√™ pode viver sem ela mas sem d√∫vida facilita ler as coisas." 

Hadley Wickham


+ [Google's R style guide](https://google.github.io/styleguide/Rguide.html)
+ [tidyverse](https://style.tidyverse.org/)
+ [Advanced R](http://adv-r.had.co.nz/Style.html)

Independente do estilo, o que importa √© ser consistente!

`Ctrl+Shift+A` Reformata o c√≥digo automaticamente

pacote __formatR__ 


---
background-image: url("figs/rpackages.png")
background-size: 300px
background-position: 90% 50%

### Terceira etapa: Transforma√ß√£o em pacote


&lt;img src="figs/guilherme.png" width="90" /&gt;
Guilherme Gall (LNCC)

--

+ Estrutura especial das pastas
+ Documenta√ß√£o espec√≠fica
+ Licen√ßa
+ "Vignettes"
+ Documenta√ß√£o cuidadosa
+ Passar testes!
+ Submiss√£o a CRAN _`#medo`_

--

#### Pacotes para ajudar:
+ `devtools`  
+ `roxygen2`  



---
### Estrutura de um pacote de R

```bash
.
‚îú‚îÄ‚îÄ R/           # Fun√ß√µes
‚îú‚îÄ‚îÄ man/         # Documenta√ß√£o
‚îú‚îÄ‚îÄ data/        # Dados
‚îú‚îÄ‚îÄ vignettes/   # Vignettes
‚îú‚îÄ‚îÄ inst/        # Os manuais que ficam quando voc√™ instala
‚îú‚îÄ‚îÄ .buildignore # Arquivos e pastas que n√£o ser√£o controlados
‚îú‚îÄ‚îÄ DESCRIPTION  # Descri√ß√£o do pacote
‚îú‚îÄ‚îÄ NAMESPACE    # NAMESPACE
‚îî‚îÄ‚îÄ README.md    # README
```

+ O pr√≥prio pacote pode ser criado usando as op√ß√µes de RStudio
+ O pacote __usethis__ (fun√ß√£o `usethis::create_package()`)
+ Alguns elementos s√£o obrigat√≥tios (DESCRIPTION, NAMESPACE, R, man)

---
### R e data

```bash
.
*‚îú‚îÄ‚îÄ R/           # Fun√ß√µes
*‚îú‚îÄ‚îÄ man/         # Documenta√ß√£o
*‚îú‚îÄ‚îÄ data/        # Dados
‚îú‚îÄ‚îÄ vignettes/   # Vignettes
‚îú‚îÄ‚îÄ inst/        # Relat√≥rios reprodut√≠veis a partir dos outputs
‚îú‚îÄ‚îÄ .buildignore # Arquivos e pastas que n√£o ser√£o controlados
‚îú‚îÄ‚îÄ DESCRIPTION  # Descri√ß√£o do pacote
‚îú‚îÄ‚îÄ NAMESPACE    # NAMESPACE
‚îî‚îÄ‚îÄ README.md    # README
```

+ As __fun√ß√µes__ est√£o na pasta `R/`
+ A documenta√ß√£o das fun√ß√µes estar√° em `man/`
+ Os __dados__ estar√£o na pasta `data/` `(data(cars)`)

---
### DESCRIPTION

```bash
.
‚îú‚îÄ‚îÄ R/           # Fun√ß√µes
‚îú‚îÄ‚îÄ man/         # Documenta√ß√£o
‚îú‚îÄ‚îÄ data/        # Dados
‚îú‚îÄ‚îÄ vignettes/   # Vignettes
‚îú‚îÄ‚îÄ inst/        # Relat√≥rios reprodut√≠veis a partir dos outputs
‚îú‚îÄ‚îÄ .buildignore # Arquivos e pastas que n√£o ser√£o controlados
*‚îú‚îÄ‚îÄ DESCRIPTION  # Descri√ß√£o do pacote
‚îú‚îÄ‚îÄ NAMESPACE    # NAMESPACE
‚îî‚îÄ‚îÄ README.md    # README
```

&lt;small&gt;
A DESCRIPTION do pacote √© editada a m√£o. 
```
Package: rladiesrio
Type: Package
Title: Isto √© um esqueleto de pacote de teste
Version: 0.1.0
Author: RLadies+ Rio de Janeiro
Maintainer: Andrea S√°nchez-Tapia &lt;andreasancheztapia@gmail.com&gt;
Description: Este esqueleto permite entender a estrutura de um pacote. 
License: MIT
Encoding: UTF-8
LazyData: true
RoxygenNote: 7.1.0
```
&lt;/small&gt;
---
### NAMESPACE

```bash
.
‚îú‚îÄ‚îÄ R/           # Fun√ß√µes
‚îú‚îÄ‚îÄ man/         # Documenta√ß√£o
‚îú‚îÄ‚îÄ data/        # Dados
‚îú‚îÄ‚îÄ vignettes/   # Vignettes
‚îú‚îÄ‚îÄ inst/        # Relat√≥rios reprodut√≠veis a partir dos outputs
‚îú‚îÄ‚îÄ .buildignore # Arquivos e pastas que n√£o ser√£o controlados
‚îú‚îÄ‚îÄ DESCRIPTION  # Descri√ß√£o do pacote
*‚îú‚îÄ‚îÄ NAMESPACE    # NAMESPACE
‚îî‚îÄ‚îÄ README.md    # README
```
O NAMESPACE indica quais fun√ß√µes ser√£o __importadas__ ou __exportadas__ pelo pacote

```
*# Generated by roxygen2: do not edit by hand

export(create_buffer)
export(do_any)
import(graphics)
import(raster)
importFrom(Rdpack,reprompt)
importFrom(dismo,randomPoints)
```

---
### __roxygen2__ e a documenta√ß√£o das fun√ß√µes

```bash
.
‚îú‚îÄ‚îÄ R/           # Fun√ß√µes
*‚îú‚îÄ‚îÄ man/         # Documenta√ß√£o
‚îú‚îÄ‚îÄ data/        # Dados
‚îú‚îÄ‚îÄ vignettes/   # Vignettes
‚îú‚îÄ‚îÄ inst/        # Relat√≥rios reprodut√≠veis a partir dos outputs
‚îú‚îÄ‚îÄ .buildignore # Arquivos e pastas que n√£o ser√£o controlados
‚îú‚îÄ‚îÄ .gitignore   # Arquivos e pastas que ser√£o ignorados por git
‚îú‚îÄ‚îÄ *.Rproj      # Projeto de RStudio
‚îú‚îÄ‚îÄ DESCRIPTION  # Descri√ß√£o do pacote
‚îú‚îÄ‚îÄ NAMESPACE    # NAMESPACE
‚îî‚îÄ‚îÄ README.md    # README
```

+ Antes era preciso escrever √† m√£o a documenta√ß√£o, o NAMESPACE e a DESCRIPTION.
+ Hoje: os par√¢metros das fun√ß√µes podem ser documentados diretamente nos arquivos em R/ com um m√©todo diferente: `#'` e indicando os par√¢metros, e as fun√ß√µes de pacotes que ser√£o usadas 

---
### __roxygen2__ e a documenta√ß√£o das fun√ß√µes

```
#' Titulo da funcao
#'
#' descricao
#'
#' @param parametro1 descri√ß√£o do par√¢metro1
#' @param parametro2 descri√ß√£o do par√¢metro2
#' @Import pacote
#' @ImportFrom pacote funcao funcao funcao
#' @details
#' @returns um data.frame
*#' @export #para que entre no NAMESPACE
#' @examples
um exemplo reprodut√≠vel, curto
funcao &lt;- function(x) {
funfunfun
}
```
+ Op√ß√£o `code &gt; Insert Roxygen Skeleton` no menu de RStudio
+ Quando a documenta√ß√£o √© escrita: `devtools::document()`
+ Vai criar os arquivos em man/ e editar o NAMESPACE

---
### Outras formas de documenta√ß√£o: vignettes e README

```bash
.
‚îú‚îÄ‚îÄ R/           # Fun√ß√µes
‚îú‚îÄ‚îÄ man/         # Documenta√ß√£o
‚îú‚îÄ‚îÄ data/        # Dados
*‚îú‚îÄ‚îÄ vignettes/   # Vignettes
‚îú‚îÄ‚îÄ inst/        # Relat√≥rios reprodut√≠veis a partir dos outputs
‚îú‚îÄ‚îÄ .buildignore # Aqui tem que estar README.Rmd que √© um arquivo opcional
‚îú‚îÄ‚îÄ DESCRIPTION  # Descri√ß√£o do pacote
‚îú‚îÄ‚îÄ NAMESPACE    # NAMESPACE
*‚îú‚îÄ‚îÄ README.Rmd    # README em rmarkdown que √© knittado para criar o md
*‚îî‚îÄ‚îÄ README.md    # README
```

+ README e vignettes s√£o arquivos de rmarkdown que s√£o knittados 

&lt;img src="./figs/rmarkdown.png" width="100" /&gt;

---
### __.buildignore__ permite ignorar arquivos fora do padr√£o ou que ainda n√£o est√£o prontos

```bash
.
‚îú‚îÄ‚îÄ R/           # Fun√ß√µes
‚îú‚îÄ‚îÄ man/         # Documenta√ß√£o
‚îú‚îÄ‚îÄ data/        # Dados
‚îú‚îÄ‚îÄ vignettes/   # Vignettes
‚îú‚îÄ‚îÄ inst/        # Relat√≥rios reprodut√≠veis a partir dos outputs
*‚îú‚îÄ‚îÄ .buildignore # Aqui tem que estar README.Rmd que √© um arquivo opcional
‚îú‚îÄ‚îÄ DESCRIPTION  # Descri√ß√£o do pacote
‚îú‚îÄ‚îÄ NAMESPACE    # NAMESPACE
*‚îú‚îÄ‚îÄ README.Rmd    # README em rmarkdown que √© knittado para criar o md
‚îî‚îÄ‚îÄ README.md    # README
```
---
background-image: url("figs/testthat.png")
background-position: 98% 2%
background-size: 150px


### Checando o pacote


+ Pacote __testthat__ para criar testes formais com expectativas

+ Para checar se o pacote est√° funcionando: `devtools::load_all()` sem precisar instalar mas vai contar se pode ser usado
+ Quando o pacote foi terminado: hora dos tests! `devtools::check()`
+ Vai rodar os tests de CRAN e fazer um diagn√≥stico do pacote. 
+ Quando est√° passando tests üéâ

![](figs/tests.png)

+ Pode mandar para GitHub e __o pacote pode ser instalado desde GitHub__

`remotes::install_github("Model-R/modelr_pkg", build_vignettes = TRUE)`

--

---
background-image: url("figs/usethis.png")
background-position: 98% 2%
background-size: 150px

### Fluxos automatizados : __usethis__

---
background-image: url("figs/testthat.png")
background-position: 98% 2%
background-size: 150px

### Tests formais: __testthat__

---
background-image: url("figs/pkgdown-logo.png")
background-position: 98% 2%
background-size: 150px
### Uma p√°gina para o seu pacote: __pkgdown__

&lt;img src="./figs/pkgdown.png" width="350" /&gt;

+ `pkgdown::build_site()` vai knittar tudo em formato de p√°gina web e colocar em uma pasta __docs/__ do pacote
+ O reposit√≥rio de GitHub tem que estar configurado para fazer uma p√°gina a partir dessa pasta
+ O readme ou um index.md ser√£o a primeira p√°gina
+ A vignette principal ir√° em Get started
+ Vignettes adicionais __que n√£o est√£o no pacote__ devem ir em vignettes/articles e ir√£o na aba Articles

---
### Li√ß√µes nestes anos

+ Trabalho colaborativo entre institui√ß√µes e √°reas do conhecimento (JBRJ, LNCC, IIS)
+ Boas perguntas
+ Limpeza de dados!
+ Paci√™ncia
+ Controle de vers√µes, √™nfase na documenta√ß√£o
+ Testes pelos usu√°rios (Vers√£o web/php OK, falta muito trabalho no teste direto do pacote)

---
### Sobre qualquer _script_ em geral

.pull-left[
`N√£o`
+ Use `setwd()` e a mesma sess√£o para diferentes projetos
+ Use pastas absolutas (`"C://Eu/Minha_pasta/"`)
+ Dependa do workspace: chega de salvar e carregar o `.RData`.
]

.pull-right[
`Sim`
+ Use os projetos de RStudio! (`.RProj`) 
+ Em vez disso `("aqui", "./subpasta","../pasta do lado")` 
+ E escreva arquivos de output e leia-os
+ Invista em aprender a usar __git__ e __github__ ou __bitbucket.__
+ Documente e comente tudo o que puder
+ Use um padr√£o de c√≥digo (espa√ßos, indenta√ß√£o, etc...)
]

---
### Sobre a cria√ß√£o de pacotes

+ Pense bem se vale a pena fazer o pacote ü§î Manuten√ß√£o, atualiza√ß√£o e comunidade de usu√°ries.
--

+ Pense bem nos fluxos de trabalho: quantas fun√ß√µes, o que entra em cada fase? o que sai? Modularize
--

+ Separe os problemas de c√≥digo e resolva para um caso s√≥
--

+ Convirta o c√≥digo em fun√ß√µes (o "_for loop_" √© um passo intermedi√°rio)
--


+ Invista em aprender sobre __git__ e __GitHub__/__Gitlab__/__Bitbucket__
--


+ N√£o fa√ßa do zero: use __roxygen2__, __devtools__, __usethis__, __testthat__
--

+ Cuide da documenta√ß√£o e crie vignettes e exemplos (por defini√ß√£o eles ter√£o de ser reprodut√≠veis)
--

+ Crie uma p√°gina web com  __pkgdown__ e divulgue seu trabalho #rstats, #rladies
--

+ Teste, cuide des usu√°ries e da comunidade ao redor do pacote ‚ù§Ô∏è



---
class: center, middle

# ¬°Obrigada!

<i class="fas  fa-paper-plane " style="color:#562457;"></i> [andreasancheztapia@gmail.com](mailto:andreasancheztapia@gmail.com) 

<i class="fab  fa-twitter " style="color:#562457;"></i> [@SanchezTapiaA](https://twitter.com/SanchezTapiaA) 

<i class="fab  fa-github " style="color:#562457;"></i> <i class="fab  fa-gitlab " style="color:#562457;"></i> <i class="fab  fa-bitbucket " style="color:#562457;"></i> [andreasancheztapia](http://github.com/andreasancheztapia) 

<i class="fab  fa-r-project " style="color:#562457;"></i> [R-Ladies+ Rio de Janeiro](https://www.meetup.com/pt-BR/rladies-rio/)

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
